<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>ì„¤ë¬¸ ì‘ì‹œ ìƒì„¸ ë‚´ì—­ - [[${sessionKey}]]</title>
    <script src="https://code.jquery.com/jquery-latest.min.js"></script>
    <style>
        body { font-family: 'Malgun Gothic', sans-serif; margin: 20px; background-color: #f8f8f8; }
        .container { max-width: 1000px; margin: 0 auto; background-color: #fff; padding: 25px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }

        /* 1. ìƒë‹¨ ìš”ì•½ ì •ë³´ ìŠ¤íƒ€ì¼ */
        .summary-box { display: flex; justify-content: space-between; margin-bottom: 25px; padding: 15px; background-color: #e9f7ef; border-radius: 6px; }
        .summary-item { flex-basis: 30%; }
        .summary-title { font-weight: bold; color: #1e8449; margin-bottom: 5px; }
        .summary-value { font-size: 1.1em; color: #333; }

        /* 2. ìƒì„¸ í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
        .detail-table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        .detail-table th, .detail-table td {
            border: 1px solid #c7c7c7;
            padding: 10px;
            text-align: center;
        }
        .detail-table th { background-color: #4a6fa5; color: white; font-weight: normal; }
        .detail-table .question-text-col { text-align: left; width: 35%; font-weight: 500; }

        /* 3. ì ìˆ˜ ê°•ì¡° ìŠ¤íƒ€ì¼ (í•µì‹¬!) */
        .highlight-score {
            background-color: #ffeb3b; /* ë…¸ë€ìƒ‰ */
            font-weight: bold;
            color: #000;
        }
        .selected-answer {
             background-color: #c8e6c9; /* ì„ íƒëœ ë‹µë³€ì˜ í–‰ ë°°ê²½ìƒ‰ */
        }

        /* ğŸ”‘ ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì¶”ê°€ */
        .action-container {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        .list-btn {
            padding: 10px 20px;
            font-size: 1em;
            background-color: #6c757d; /* Gray */
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .list-btn:hover {
            background-color: #5a6268;
        }
    </style>
    <script th:inline="javascript">
    /* <![CDATA[ */
    document.addEventListener('DOMContentLoaded', function() {
        const detail = [[${detailData}]];
        const V_MARK = 'V';

        // 4ë²ˆë¶€í„° 9ë²ˆ ë¬¸í•­ê¹Œì§€ ìˆœíšŒí•˜ë©° ìƒ‰ì¹ 
        for (let i = 4; i <= 9; i++) {
            const scoreKey = `Q${i}_SCORE`;
            const actualScore = detail[scoreKey];

            if (actualScore !== null) {
                const selector = `.question-row[data-question-id="${i}"] td[data-score="${actualScore}"]`;
                const selectedCell = document.querySelector(selector);

                if (selectedCell) {
                    selectedCell.classList.add('highlight-score');
                    selectedCell.textContent = V_MARK;

                    // (ì„ íƒì‚¬í•­) í–‰ ì „ì²´ë¥¼ ê°•ì¡°
                    selectedCell.closest('tr').classList.add('selected-answer');
                }
            }
        }

        // ğŸ”‘ ëª©ë¡ ë²„íŠ¼ ì´ë²¤íŠ¸ ì—°ê²° (jQuery($) ëŒ€ì‹  jQuery ì§ì ‘ ì‚¬ìš©)
        $('#listBtn').on('click', function() {
            const userId = [[${userId}]];
            window.location.href = '/survey/ext/list?userId=' + userId;
        });
    });
    /* ]]> */
</script>
</head>
<body>

    <div class="container">
        <h2 style="text-align: center;">ì„¤ë¬¸ ì‘ì‹œ ìƒì„¸ ë‚´ì—­ ([[${sessionKey}]] íšŒì°¨)</h2>

        <div class="summary-box">
            <div class="summary-item">
                <div class="summary-title">í‰ê°€ì / ì—…ì²´ëª…</div>
                <div class="summary-value" th:text="|${detailData.USERNM} (${detailData.COMPANYNM})|"></div>
            </div>
            <div class="summary-item">
                <div class="summary-title">ì ê²€ ì¼ì‹œ / ì´ì </div>
                <div class="summary-value" th:text="|${#dates.format(detailData.ANSWERAT, 'yyyy-MM-dd HH:mm')} / ${detailData.TOTALSCORE}ì |"></div>
            </div>
            <div class="summary-item">
                <div class="summary-title">ê¸°ë³¸ ì •ë³´ (ì—…ì¢…/ì§ì±…)</div>
                <div class="summary-value" th:text="|${detailData.Q1_UPJONG} / ${detailData.Q3_JIKCHEK}|"></div>
            </div>
        </div>

        <h3>Part 2. ìœ„í—˜ ë° ëŒ€ì‘ ìƒì„¸ í‰ê°€</h3>
            <table class="detail-table">
        <thead>
            <tr>
                <th class="question-text-col" rowspan="2">ì£¼ìš” í•­ëª©</th> <th colspan="4">í‰ê°€ ì˜µì…˜ (V í‘œì‹œ ì˜ì—­)</th> <th rowspan="2">íšë“ ì ìˆ˜</th> </tr>
            <tr>
                <th style="width: 12%;">ë§¤ìš° ë¯¸í¡ (0ì )</th>
                <th style="width: 12%;">ë¯¸í¡ (1ì )</th>
                <th style="width: 12%;">ì–‘í˜¸ (2ì )</th>
                <th style="width: 12%;">ë§¤ìš° ì–‘í˜¸ (3ì )</th>
            </tr>
        </thead>
        <tbody>
            <tr class="question-row" data-question-id="4">
                <td class="question-text-col">4. ì•ˆì „ë³´ê±´ê²½ì˜ë°©ì¹¨ì´ ìˆ˜ë¦½ë˜ì–´ ìˆê³ , ê·¸ ë°©ì¹¨ì— ë”°ë¥¸ ëª©í‘œê°€ ì •ëŸ‰ì ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆëŠ”ê°€?</td>
                <td data-score="0"></td>
                <td data-score="1"></td>
                <td data-score="2"></td>
                <td data-score="3"></td>
                <td th:text="${detailData.Q4_SCORE}">1</td>
            </tr>
            <tr class="question-row" data-question-id="5">
                <td class="question-text-col">5. ì‚¬ì—…ì¥ ë‚´ ìœ í•´Â·ìœ„í—˜ìš”ì¸ì— ëŒ€í•œ ìœ„í—˜ì„± í‰ê°€ë¥¼ ìµœì´ˆ ë° ì •ê¸°ì ìœ¼ë¡œ ì‹¤ì‹œí•˜ê³  ìˆëŠ”ê°€?</td>
                <td data-score="0"></td>
                <td data-score="1"></td>
                <td data-score="2"></td>
                <td data-score="3"></td>
                <td th:text="${detailData.Q5_SCORE}">0</td>
            </tr>
             <tr class="question-row" data-question-id="6">
                <td class="question-text-col">6. ìœ„í—˜ì„± í‰ê°€ ê²°ê³¼ë¥¼ ê·¼ë¡œìì—ê²Œ íš¨ê³¼ì ìœ¼ë¡œ ê³µìœ  ë° êµìœ¡í•˜ê³  ìˆëŠ”ê°€?</td>
                <td data-score="0"></td>
                <td data-score="1"></td>
                <td data-score="2"></td>
                <td data-score="3"></td>
                <td th:text="${detailData.Q6_SCORE}">2</td>
            </tr>
            <tr class="question-row" data-question-id="7">
                <td class="question-text-col">7. ì¤‘ëŒ€ì¬í•´ ë“± ë¹„ìƒìƒí™©ì— ëŒ€ë¹„í•œ ë¹„ìƒì¡°ì¹˜ ê³„íšì„ ìˆ˜ë¦½í•˜ê³  ëª¨ì˜í›ˆë ¨ì„ ì‹¤ì‹œí•˜ëŠ”ê°€?</td>
                <td data-score="0"></td>
                <td data-score="1"></td>
                <td data-score="2"></td>
                <td data-score="3"></td>
                <td th:text="${detailData.Q7_SCORE}">0</td>
            </tr>
            <tr class="question-row" data-question-id="8">
                <td class="question-text-col">8. ë²•ì • ì•ˆì „ë³´ê±´ êµìœ¡(ì •ê¸°, ì±„ìš© ì‹œ, ì‘ì—… ë³€ê²½ ì‹œ ë“±)ì„ ì •í•´ì§„ ì£¼ê¸°ë¡œ ì‹¤ì‹œí•˜ê³  ìˆëŠ”ê°€?</td>
                <td data-score="0"></td>
                <td data-score="1"></td>
                <td data-score="2"></td>
                <td data-score="3"></td>
                <td th:text="${detailData.Q8_SCORE}">3</td>
            </tr>
            <tr class="question-row" data-question-id="9">
                <td class="question-text-col">9. ì•ˆì „ ë° ë³´ê±´ ê´€ë ¨ ì‚¬í•­ì— ëŒ€í•´ ê·¼ë¡œìì˜ ì˜ê²¬ì„ ìˆ˜ë ´í•˜ê³  ë°˜ì˜í•˜ëŠ”ê°€?</td>
                <td data-score="0"></td>
                <td data-score="1"></td>
                <td data-score="2"></td>
                <td data-score="3"></td>
                <td th:text="${detailData.Q9_SCORE}">1</td>
            </tr>
        </tbody>
    </table>

        <div class="action-container">
             <button type="button" id="listBtn" class="list-btn">ëª©ë¡ìœ¼ë¡œ ê°€ê¸°</button>
        </div>

    </div>
</body>
</html>